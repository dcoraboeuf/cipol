<#include "/_layouts.html">
<@layout_simple pageId="policy" titleKey="policy.title" forms=true>
	<article class="policy">
		<section class="policy">
			<header>
				${policy.name?html}
			</header>
			<div>
				<table>
					<tbody>
						<@form_text_field
							id="uid"
							label=loc("model.policy.uid")
							size=40
							value=policy.uid
							editable=false
							/>
						<@form_text_field
							id="name"
							label=loc("model.policy.name")
							value=policy.name
							editable=true
							action="ui/policy/update/${policy.uid}"
							/>
						<@form_text_field
							id="description"
							label=loc("model.policy.description")
							size=40
							value=policy.description
							editable=true
							action="ui/policy/update/${policy.uid}"
							/>
					</tbody>
				</table>
			</div>
		</section>
		<section class="policy policy-groups">
			<header>
				Groups
			</header>
			<div>
				<table>
					<tbody>
						<#list policy.groups as group>
							<tr>
								<th>
									${group.name?html}
								</th>
								<#list group.members as member>
									<td>${member?html}</td>
								</#list>
							</tr>
						</#list>
					</tbody>
				</table>
			</div>
		</section>
		<section class="policy policy-rules">
			<header>
				Rules
			</header>
				<div>
				<#list policy.rules as ruleset>
					<section class="policy-ruleset">
						<header>
							<span class="policy-ruleset-path">${ruleset.path}</span>
							<span class="policy-ruleset-description">${ruleset.description?html}</span>
							<@disabled value=ruleset.disabled />
						</header>
						<div>
							<#list ruleset.rules as rule>
								<section class="policy-rule">
									<header>
										<span class="policy-rule-name">${rule.ruleId?html}</span>
										<span class="policy-rule-description">${rule.description?html}</span>
										<@disabled value=rule.disabled />
									</header>
									<#if rule.parameters??>
										<div class="parameters">
											<#list rule.parameters as param>
												<@parameter p=param />
											</#list>
										</div>
									</#if>
								</section>
							</#list>
						</div>
					</section>
				</#list>
			</div>
		</section>
	</article>
	<nav>
		<@form_link action="ui/" text="general.cancel" tip="policy.cancel.tip" />
		<@form_link action="ui/policy/export/${policy.uid}" text="policy.export" tip="policy.export.tip" />
		<@form_delete action="ui/policy/delete/${policy.uid}" prompt="policy.delete.prompt" tip="policy.delete.tip" />
	</nav>
</@layout_simple>